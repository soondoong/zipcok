<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="zipcok.homegym">
	<insert id="hgAddSQL"
		parameterType="zipcok.homegym.model.HomeGymDTO">
		insert into homegym values(
		#{hg_mem_id}, #{hg_nickname},
		#{hg_person_count}, #{hg_price},
		#{hg_info}, '1', #{hg_faddr},
		#{hg_saddr}, #{hg_station}, #{hg_comeinfo},
		#{hg_start_date_year},
		#{hg_start_date_month}, #{hg_start_date_day},
		#{hg_end_date_year},
		#{hg_end_date_month}, #{hg_end_date_day},
		#{hg_not_date},
		#{hg_start_time},
		#{hg_end_time},
		sysdate, sysdate, '1')
	</insert>
	<insert id="hgEqAddSQL"
		parameterType="zipcok.homegym.model.HomeGymEquipmentDTO">
		insert into homegym_equipment values(
		eq_idx.nextval,
		#{eq_mem_id}, #{eq_name}, #{eq_count})
	</insert>
	<insert id="hgImgAddSQL"
		parameterType="zipcok.coach.model.CoachFileDTO">
		insert into
		member_file
		values(
		member_file_mfile_idx.nextval,
		#{mfile_key},
		#{mfile_mem_id},
		#{mfile_upload},
		#{mfile_size},
		#{mfile_orig},
		#{mfile_path},
		#{mfile_type}
		)
	</insert>
	
	<select id="hgNickNameCheckSQL" parameterType="String"
		resultType="String">
		select hg_nickname from homegym where hg_nickname = #{hg_nickname}
	</select>
	
	<select id = "hgAvgPriceSQL" resultType="Integer">
		select avg(hg_price) from homegym
	</select>
	
	<select id="hgListSQL" parameterType="hashMap"
		resultType="zipcok.homegym.model.HomeGymDTO">
		select * from
		(select rownum as rnum, a.* from
		(select * from homegym where hg_approved_check = '1' and hg_status = '1' order by hg_regist_date desc) a) b 
		where rnum<![CDATA[>=]]> #{start} and rnum<![CDATA[<=]]>#{end}
	</select>
	
	<select id="homegymTotalCnt" parameterType="Hashmap" resultType="Integer">
		select count(*) from homegym
		where
		hg_saddr
		<choose>
			<when test = "location == '전체'">like '%%'</when>
			<when test = "location != '전체'">like '%${location}%'</when>
		</choose>
		and
		<choose>
			<when test = "year == 0">hg_start_date_year <![CDATA[>=]]> 0 and hg_end_date_year<![CDATA[<=]]>10000</when>
			<when test = "year != 0">
				hg_start_date_year <![CDATA[>=]]> ${year} and 
				hg_end_date_year <![CDATA[<=]]> ${year} and 
				hg_start_date_month <![CDATA[>=]]> ${month} and 
				hg_end_date_month <![CDATA[<=]]> ${month} and 
				hg_start_date_day <![CDATA[>=]]> ${day} and 
				hg_end_date_day <![CDATA[<=]]> ${day}
			</when>
		</choose>
	</select>
</mapper>